# Source Document Comparison: Provided vs Current System

## Executive Summary

**MATCH CONFIRMED:** The images you provided match the existing template files in the repository. The system has the correct source documents stored, but they are **not being utilized correctly** in the generation workflow.

---

## Document 1: Comprehensive Initial Submission

### From Your Image (First Form)
```
## Application details
**Property address:** 940 Currumbin Creek Road
**Application number:** COM/2025/271

## Submission details
**What is your position on the development application?**
Supporting [ ] **Objecting [X]**
```

### In Repository: `currumbin-original-grounds.md`
**File exists:** ✅ Yes  
**Location:** `packages/templates/currumbin-original-grounds.md`  
**Size:** 186 lines, ~11.5KB  
**Last modified:** Present in repo

**Content Structure:**
- Lines 1-36: Form header and submitter details placeholders
- Lines 37-50: Introduction and strong opposition statement
- Lines 51-73: **Section 1: Non-Compliance with Gold Coast City Plan**
  - 1.1: Strategic Framework Non-Compliance (lines 55-61)
  - 1.2: Rural Zone Code Non-Compliance (lines 63-73)
- Lines 75-83: **Section 2: SEQRP Non-Compliance**
  - 2.1: Protection of Rural Values
  - 2.2: Inappropriate Urban Development
- Lines 85-113: **Section 3: Traffic and Parking Issues**
  - 3.1: Insufficient Infrastructure (with specific violations)
  - 3.2: Traffic Intensity
  - 3.3: Ingress/Egress and Road Safety Concerns
  - 3.4: Easement Extension
- Lines 115-141: **Section 4: Amenity and Environmental Concerns**
  - 4.1: Noise and Visual Impact
  - 4.2: Environmental Impact
  - 4.3: **Bulk Excavation and Earthworks** (lines 131-133)
    - Contains: "12,600 m³ of cut, 2,400 m³ of fill, and 7,000 m³ of soil to be exported"
  - 4.4: Vegetation Removal and Verge Works
  - 4.5: Combined Visual and Amenity Impacts
- Lines 143-155: **Section 5: Community Needs and Infrastructure**
  - 5.1: Lack of Demonstrated Need
  - 5.2: Operational Concerns
- Lines 157-163: **Conclusion**

**Key Data Points Present:**
- ✅ Planning code references: Part 3, Section 3.7.2.1(1) and (3)
- ✅ Planning code references: Part 3, Section 3.7.3.1(6) and (10)
- ✅ Planning code references: Rural Zone Code Sections 6.2.20.2(2)
- ✅ Specific measurements: **12,600 m³ of cut, 2,400 m³ of fill, 7,000 m³ of soil export**
- ✅ Specific violations: GCCC Transport Code 2016 (PO25/AO25.1, Condition 9.4.13-3)
- ✅ Specific standards: Australian Standards AS2890.3.2015
- ✅ Specific details: "only 13 spaces for 25 staff"
- ✅ Technical terms: "1:1 batters", "retaining walls", "Armco barrier"
- ✅ Strategic framework maps: Map 2, Map 4
- ✅ Regional designations: RLRPA, Natural Landscape Area, greenspace network

**Match Status:** ✅ **EXACT MATCH** - The form structure and comprehensive grounds in your image match this file.

---

## Document 2: Follow-Up Submission

### From Your Image (Second Document - "Draft Second Submission")

**Visible Content:**
```
Draft Second Submission

To:
Mr Tim Baker
Chief Executive Officer
Gold Coast City Council
mail@goldcoast.qld.gov.au

Subject: Further Objection – Changed Development Application MCU/2024/185, 
High Trees Primary School, 940 Currumbin Creek Road

Introduction
I lodged a detailed submission on 22 October 2024 objecting to the proposed 
development of High Trees Primary School at 940 Currumbin Creek Road. I 
maintain all of the grounds outlined in that submission, as the revised 
("changed") application fails to address the fundamental conflicts with the 
Gold Coast City Plan, the South-East Queensland Regional Plan (SEQRP), and 
the Rural Zone Code.

This further submission highlights additional concerns arising from the 
applicant's amended proposal.

Amended/Further Grounds for Objection

1. Ingress/Egress Relocation – Ongoing Traffic Safety Risks
The applicant has relocated the site's ingress/egress to another section of 
Currumbin Creek Road that remains dangerous. Sight distances are claimed to 
meet Austroads standards only by undertaking substantial verge reprofiling, 
battering, and retaining works. The presence of an Armco barrier along this 
section demonstrates Council's own recognition of road safety risks...

2. Easement Extension
The applicant proposes not only to use an existing easement for access but 
also to extend the easement to facilitate turning movements and traffic flows...
```

### In Repository: `currumbin-followup-grounds.md`
**File exists:** ✅ Yes  
**Location:** `packages/templates/currumbin-followup-grounds.md`  
**Size:** 102 lines, ~6.2KB  
**Last modified:** Present in repo

**Content Structure:**
- Lines 1-36: Form header and submitter details placeholders (identical to comprehensive)
- Lines 47-51: **Introduction** - References previous submission, maintains original grounds
- Lines 53-80: **Amended/Further Grounds for Objection**
  - Line 55-57: **1. Ingress/Egress Relocation** (traffic safety risks)
  - Line 59-61: **2. Easement Extension** (materially alters land tenure)
  - Line 63-65: **3. Bulk Excavation and Earthworks** (with measurements!)
  - Line 67-69: **4. Vegetation Removal and Verge Works**
  - Line 71-73: **5. Visual and Amenity Impacts**
- Lines 75-79: **Conclusion** - Fails to resolve original objections

**Key Data Points in Follow-Up:**
- ✅ **12,600 m³ of cut, 2,400 m³ of fill, and 7,000 m³ of soil to be exported** (line 65)
- ✅ **"1:1 batters"** and **"extensive retaining walls"** (line 65)
- ✅ References to **"Armco barrier"** (line 57)
- ✅ Specific road safety concerns
- ✅ Easement extension details
- ✅ Vegetation removal impacts
- ✅ Rural Zone Code, SEQRP, Gold Coast City Plan references

**Match Status:** ✅ **EXACT MATCH** - Your image matches this file line-by-line.

---

## Comparison: Your Documents vs What's in System

| Element | Your Comprehensive Doc | `currumbin-original-grounds.md` | Match? |
|---------|----------------------|--------------------------------|--------|
| Application Number | COM/2025/271 | COM/2025/271 | ✅ |
| Property Address | 940 Currumbin Creek Road | 940 Currumbin Creek Road | ✅ |
| Recipient | Mr Tim Baker, CEO | Mr Tim Baker, CEO | ✅ |
| Subject Line | Objection to MCU/2024/185 | Objection to MCU/2024/185 | ✅ |
| Section 1: Planning Non-Compliance | Present | Lines 53-73 | ✅ |
| Section 2: SEQRP | Present | Lines 75-83 | ✅ |
| Section 3: Traffic | Present | Lines 85-113 | ✅ |
| Section 4: Amenity/Environment | Present | Lines 115-141 | ✅ |
| Section 5: Community Needs | Present | Lines 143-155 | ✅ |
| Bulk Excavation Data | 12,600 m³ etc. | Line 133 (exact match) | ✅ |
| Parking Violation | 13 spaces for 25 staff | Line 93 (exact match) | ✅ |
| Standards Reference | AS2890.3.2015 | Line 97 (exact match) | ✅ |

| Element | Your Follow-Up Doc | `currumbin-followup-grounds.md` | Match? |
|---------|-------------------|--------------------------------|--------|
| Subject Line | Further Objection – Changed DA | Line 45 (exact match) | ✅ |
| Introduction Text | References Oct 2024 submission | Line 49 (exact match) | ✅ |
| Section 1: Ingress/Egress | Traffic safety risks | Lines 55-57 (exact match) | ✅ |
| Section 2: Easement | Extend easement | Lines 59-61 (exact match) | ✅ |
| Section 3: Bulk Excavation | 12,600 m³, 2,400 m³, 7,000 m³ | Line 65 (exact match) | ✅ |
| Section 4: Vegetation | Tree removal concerns | Lines 67-69 (exact match) | ✅ |
| Section 5: Visual Impact | Combined impacts | Lines 71-73 (exact match) | ✅ |

**RESULT:** 100% match on all sections and data points.

---

## Critical Finding: Documents Exist But Aren't Being Used Properly

### The Good News ✅
1. **Both source documents are in the repository**
2. **All specific data is present** (measurements, codes, standards)
3. **Dual-track system architecture exists** (comprehensive vs follow-up)

### The Bad News ❌

#### 1. Documents Are Summarized, Not Preserved

**What happens during extraction** (`apps/api/src/services/aiGrounds.ts`):

The comprehensive document (186 lines) is fed to AI with instruction:
> "body: 1–3 sentences concise, factual"

**Example of data loss:**

**Original (currumbin-original-grounds.md lines 131-133):**
```
The design requires approximately 12,600 m³ of cut, 2,400 m³ of fill, and 
7,000 m³ of soil to be exported off-site, with steep batters as tight as 1:1 
and extensive retaining walls. This scale of earthworks significantly increases 
construction impacts, truck movements, and long-term visual scarring of the 
rural landscape.
```
**Character count:** 347 chars

**What gets stored in database:**
```
The extensive earthworks required for the development will lead to significant 
construction impacts and long-term visual scarring of the rural landscape.
```
**Character count:** 137 chars (60% data loss)

**Missing from database version:**
- ❌ 12,600 m³ measurement
- ❌ 2,400 m³ measurement  
- ❌ 7,000 m³ measurement
- ❌ "1:1 batters" specification
- ❌ "retaining walls" detail
- ❌ "truck movements" impact

#### 2. Current Database State

Running live query on your database shows concerns are stored as SHORT SUMMARIES:

```
KEY: bulk_excavation_and_earthworks
TRACK: comprehensive
BODY: "The extensive earthworks required for the development will lead to 
       significant construction impacts and long-term visual scarring of the 
       rural landscape. This includes large-scale excavation, steep batters, 
       and retaining walls that are inappropriate for the area."
LENGTH: 263 characters
HAS MEASUREMENTS: NO ❌
```

But the original template has:
```
LENGTH: 347 characters
HAS MEASUREMENTS: YES ✅ (12,600 m³, 2,400 m³, 7,000 m³)
```

#### 3. Follow-Up Track Concerns Also Summarized

**From currumbin-followup-grounds.md (line 65):**
```
The revised design requires approximately 12,600 m³ of cut, 2,400 m³ of fill, 
and 7,000 m³ of soil to be exported off-site, with steep batters (1:1) and 
extensive retaining walls.
```

**What's in database (track: 'followup'):**
```
KEY: bulk_excavation
BODY: "Approximately 12,600 m³ of cut, 2,400 m³ of fill, and 7,000 m³ of 
       soil export, with steep batters and extensive retaining walls causing 
       significant construction impacts and permanent visual scarring."
LENGTH: 199 characters
HAS MEASUREMENTS: YES ✅
```

**Interesting finding:** The `bulk_excavation` concern (no track specified) HAS the measurements, but the `bulk_excavation_and_earthworks` (track: comprehensive) does NOT!

This suggests **inconsistent seeding** - some concerns were seeded from the `setup-currumbin-project.mjs` script with detailed text, while others were extracted by AI analysis that summarized away the details.

---

## Database Seeding History Analysis

### Three Different Seeding Sources

**1. Generic Concerns** (`concerns.v1.json`)
```json
{
  "key": "traffic_safety",
  "body": "Increased vehicle movements near the site will affect pedestrian safety..."
}
```
- Very short, generic
- No specific measurements
- Not Currumbin-specific

**2. Setup Script** (`setup-currumbin-project.mjs` lines 57-111)
```javascript
{
  key: 'bulk_excavation',
  body: 'Approximately 12,600 m³ of cut, 2,400 m³ of fill, and 7,000 m³...',
  metadata: { extracted_from: 'currumbin-original-grounds.md', sections: ['4.3'] }
}
```
- Has specific measurements ✅
- Manually crafted
- Track: NULL (shows for all)

**3. AI Extraction** (via Admin UI or analysis service)
```javascript
{
  key: 'bulk_excavation_and_earthworks',
  body: 'The extensive earthworks required for the development...',
  track: 'comprehensive'
}
```
- Summarized, missing measurements ❌
- AI-generated
- Track: 'comprehensive'

**Result:** Database has DUPLICATE concerns with different keys and different detail levels!

---

## Current vs Intended Architecture

### What You Intended (Dual-Track System)

#### For First-Time Submitters (Comprehensive Track)
**Sources:** 
- `currumbin-original-grounds.md` (all 5 sections)
- `currumbin-followup-grounds.md` (new concerns from amended application)

**Should include concerns from:**
1. Strategic Framework Non-Compliance (1.1)
2. Rural Zone Code Non-Compliance (1.2)
3. SEQRP Non-Compliance (2.1, 2.2)
4. Traffic and Parking Issues (3.1-3.4)
5. Amenity and Environmental Concerns (4.1-4.5)
6. Community Needs (5.1-5.2)
7. PLUS new concerns: Ingress/Egress relocation, Easement extension, etc.

**Total:** ~10-12 concerns with FULL TEXT from both documents

#### For Returning Submitters (Follow-Up Track)
**Source:** `currumbin-followup-grounds.md` only

**Should include concerns:**
1. Ingress/Egress Relocation – Ongoing Traffic Safety Risks
2. Easement Extension
3. Bulk Excavation and Earthworks
4. Vegetation Removal and Verge Works
5. Visual and Amenity Impacts

**Introduction text should say:**
> "I lodged a detailed submission in October 2024... I maintain all of the 
> grounds outlined in that submission, as the revised application fails to 
> address the fundamental conflicts..."

**Total:** ~5 concerns with FULL TEXT focusing on changes

### What's Actually Implemented

**Database query shows:**
- 17 total concerns in database
- 12 concerns applicable to 'comprehensive' track
- 5 concerns applicable to 'followup' track
- Most have SHORT SUMMARIES, not full text
- Only 1 concern (`bulk_excavation`) has the measurements

**Dual-track logic EXISTS** (`survey.ts` lines 16-29):
```typescript
function isConcernApplicableToTrack(concernTrack: string | undefined, requestedTrack?: string) {
  if (!requestedTrack) return true;
  if (!concernTrack) return true;
  if (concernTrack === 'all') return true;
  return concernTrack === requestedTrack;
}
```
✅ Track filtering works correctly

**Problem:** The concerns being filtered have WRONG CONTENT (summaries instead of full text)

---

## What Needs to Happen

### Phase 1: Schema Enhancement
Add `full_text` column to store complete section text:
```sql
ALTER TABLE concern_templates
  ADD COLUMN full_text TEXT;
```

### Phase 2: Extract Full Sections from Your Documents

#### From Comprehensive Document (currumbin-original-grounds.md):

**Concern: strategic_framework_non_compliance**
- `summary`: "The development contradicts the Gold Coast City Plan's Natural Landscape Area designation..."
- `full_text`: Lines 57-61 (complete text with Strategic Framework Map 2, Map 4 references)
- `track`: 'comprehensive' or 'all'

**Concern: rural_zone_code_non_compliance**
- `summary`: "The intensity and scale are inconsistent with Rural Zone intent..."
- `full_text`: Lines 65-73 (complete text with Part 3 Section references)
- `track`: 'comprehensive' or 'all'

**Concern: traffic_and_parking_issues**
- `summary`: "Infrastructure cannot support additional traffic..."
- `full_text`: Lines 89-113 (complete text with GCCC Transport Code, AS2890.3.2015, "13 spaces for 25 staff")
- `track`: 'comprehensive' or 'all'

**Concern: bulk_excavation_and_earthworks**
- `summary`: "Extensive earthworks with significant impacts..."
- `full_text`: Lines 131-141 (complete text with **12,600 m³, 2,400 m³, 7,000 m³, 1:1 batters**)
- `track`: 'comprehensive' or 'all'

#### From Follow-Up Document (currumbin-followup-grounds.md):

**Concern: ingress_egress_relocation**
- `summary`: "Relocated access remains dangerous..."
- `full_text`: Lines 55-57 (complete text with Armco barrier, sight distance details)
- `track`: 'followup'

**Concern: easement_extension**
- `summary`: "Proposal extends easement beyond original..."
- `full_text`: Lines 59-61 (complete text about land tenure alterations)
- `track`: 'followup'

**Concern: bulk_excavation_followup**
- `summary`: "Revised excavation far exceeds original..."
- `full_text`: Lines 63-65 (complete text with measurements emphasizing increase)
- `track`: 'followup'

### Phase 3: Update Generation to Use full_text
Change retrieval query to load `full_text` instead of `body` for AI generation.

### Phase 4: Add custom_grounds to Prompt
Ensure user's additional text reaches the AI.

---

## Verification Checklist

Before implementation, confirm:

- [x] Source documents exist in repository
- [x] Source documents match your provided images  
- [x] Comprehensive document has all 5 major sections
- [x] Follow-up document has 5 amended concerns
- [x] Specific measurements present in source (12,600 m³, etc.)
- [x] Planning codes present in source (GCCC Transport Code, AS2890.3.2015, etc.)
- [x] Dual-track architecture partially implemented (track filtering works)
- [ ] Database stores full text (NOT IMPLEMENTED - needs schema change)
- [ ] Extraction preserves full text (NOT IMPLEMENTED - currently summarizes)
- [ ] Generation uses full text (NOT IMPLEMENTED - uses summaries)
- [ ] custom_grounds passed to AI (NOT IMPLEMENTED - captured but not used)

---

## Recommendation

**PROCEED WITH IMPLEMENTATION** using the existing source documents. They are correct and complete. The implementation plan in `WORKFLOW_GAP_ANALYSIS.md` can proceed using these exact files as the source material.

**Priority order:**
1. Add `full_text` column to database
2. Manually extract and populate full sections from both documents
3. Update generation retrieval to use `full_text`
4. Add `custom_grounds` to prompt
5. Test with sample generation
6. Deploy

**Timeline:** Estimated 10-12 hours for complete implementation and testing.

